import type { ExecToolDefaults } from "../../agents/bash-tools.js";
import type { OpenClawConfig } from "../../config/config.js";
import type { MsgContext, TemplateContext } from "../templating.js";
import type { GetReplyOptions, ReplyPayload } from "../types.js";
import type { buildCommandContext } from "./commands.js";
import type { InlineDirectives } from "./directive-handling.js";
import type { createModelSelectionState } from "./model-selection.js";
import type { TypingController } from "./typing.js";
import { type SessionEntry } from "../../config/sessions.js";
import { type ElevatedLevel, type ReasoningLevel, type ThinkLevel, type VerboseLevel } from "../thinking.js";
import { buildGroupIntro } from "./groups.js";
type AgentDefaults = NonNullable<OpenClawConfig["agents"]>["defaults"];
type ExecOverrides = Pick<ExecToolDefaults, "host" | "security" | "ask" | "node">;
type RunPreparedReplyParams = {
    ctx: MsgContext;
    sessionCtx: TemplateContext;
    cfg: OpenClawConfig;
    agentId: string;
    agentDir: string;
    agentCfg: AgentDefaults;
    sessionCfg: OpenClawConfig["session"];
    commandAuthorized: boolean;
    command: ReturnType<typeof buildCommandContext>;
    commandSource: string;
    allowTextCommands: boolean;
    directives: InlineDirectives;
    defaultActivation: Parameters<typeof buildGroupIntro>[0]["defaultActivation"];
    resolvedThinkLevel: ThinkLevel | undefined;
    resolvedVerboseLevel: VerboseLevel | undefined;
    resolvedReasoningLevel: ReasoningLevel;
    resolvedElevatedLevel: ElevatedLevel;
    execOverrides?: ExecOverrides;
    elevatedEnabled: boolean;
    elevatedAllowed: boolean;
    blockStreamingEnabled: boolean;
    blockReplyChunking?: {
        minChars: number;
        maxChars: number;
        breakPreference: "paragraph" | "newline" | "sentence";
        flushOnParagraph?: boolean;
    };
    resolvedBlockStreamingBreak: "text_end" | "message_end";
    modelState: Awaited<ReturnType<typeof createModelSelectionState>>;
    provider: string;
    model: string;
    perMessageQueueMode?: InlineDirectives["queueMode"];
    perMessageQueueOptions?: {
        debounceMs?: number;
        cap?: number;
        dropPolicy?: InlineDirectives["dropPolicy"];
    };
    typing: TypingController;
    opts?: GetReplyOptions;
    defaultProvider: string;
    defaultModel: string;
    timeoutMs: number;
    isNewSession: boolean;
    resetTriggered: boolean;
    systemSent: boolean;
    sessionEntry?: SessionEntry;
    sessionStore?: Record<string, SessionEntry>;
    sessionKey: string;
    sessionId?: string;
    storePath?: string;
    workspaceDir: string;
    abortedLastRun: boolean;
};
export declare function runPreparedReply(params: RunPreparedReplyParams): Promise<ReplyPayload | ReplyPayload[] | undefined>;
export {};
